<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Spectrum and Irradiance</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Audiowide|Rajdhani|Courier+New">
    <style>
        /* Base styles: Ensuring a deep, consistent black background */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box; /* Includes padding and border in the element's total width and height */
            /* Default background for elements unless specified - slightly off-black for depth */
            background-color: #0a0a0a;
        }

        body {
            background-color: #000000; /* Pure black for the main page background */
            font-family: 'Audiowide', cursive; /* Keeping the distinct, futuristic font */
            color: #d3d3d3; /* A standard light grey for excellent readability on dark backgrounds */
            line-height: 1.6; /* Improves readability of text blocks */
            overflow-x: hidden; /* Prevent horizontal scroll on some subtle effects */
        }

        /* Main Heading: Bold and energetic, central to the radiation theme */
        .main_heading {
            background: linear-gradient(to right, #f40166, #ff2a68, #ff0000); /* Vibrant red/pink/orange gradient */
            font-size: 50px; /* Consistent size for prominence */
            font-family: 'Courier New', monospace; /* A classic techy font */
            font-weight: 900; /* Extra bold for impact */
            color: #000000; /* Black text creates strong contrast on the gradient */
            text-align: center;
            padding: 50px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(255, 110, 110, 0.7); /* Stronger, more defined glowing red shadow */
            margin: 30px auto; /* Centers the block and adds vertical spacing */
            max-width: 90%; /* Ensures responsiveness and readability on larger screens */
            will-change: box-shadow; /* Hint to browser for performance optimization */
        }

        /* General Paragraphs: Clean and readable, designed for content */
        p {
            font-size: 22px;
            font-family: 'Audiowide', cursive;
            text-align: center; /* Centered text within paragraphs */
            padding: 20px;
            margin: 25px auto; /* Centers the block and provides vertical spacing */
            max-width: 80%; /* Limits paragraph width for better readability */
            background-color: #1a1a1a; /* Slightly lighter charcoal for subtle visual distinction */
            border-radius: 10px;
            color: #b7b8b8; /* A muted grey for standard text */
            box-shadow: 0 0 8px rgba(255, 42, 104, 0.1); /* Very subtle, understated red glow */
            line-height: 1.7; /* Further improved readability */
        }

        /* Subtopic Headings: Consistent with the main radiation theme's subtopics */
        .subtopics {
            background-image: linear-gradient(58.2deg, rgba(255, 76, 10, 0.9) -3%, rgba(255, 0, 80, 0.8) 49.3%, rgba(255, 200, 0, 0.8) 97.7%); /* Intense, mixed-tone gradient */
            font-size: 28px;
            color: #ffffff;
            font-family: 'Audiowide', cursive;
            font-weight: bold;
            padding: 25px 40px;
            margin: 35px auto; /* Centered with generous spacing */
            max-width: 80%;
            text-align: center;
            border-radius: 15px; /* Softer radius for a less rigid feel */
            border: 2px solid #ff416c; /* A clear, vibrant red border */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            transition: all 0.4s ease; /* All-encompassing smooth transition */
            will-change: transform, box-shadow, background;
            cursor: pointer;
        }

        .subtopics:hover {
            transform: scale(1.03) translateY(-3px); /* More noticeable lift and scale */
            background-image: linear-gradient(58.2deg, rgba(255, 0, 80, 0.95) -3%, rgba(255, 76, 10, 0.95) 49.3%, rgba(255, 200, 0, 0.95) 97.7%); /* Even more intense gradient on hover */
            color: #000000; /* Black text for strong contrast on hover */
            box-shadow: 0 0 45px rgba(255, 0, 80, 0.9); /* Enhanced, stronger glow on hover */
        }

        /* Definition Section: Standard content block with clear typography */
        .def {
            background-color: #111111; /* Consistent dark background */
            font-family: 'Audiowide', cursive;
            font-size: 22px; /* Consistent with general paragraphs */
            color: #b7b8b8;
            font-weight: normal; /* Standard weight for content, avoiding excessive boldness */
            text-align: center;
            padding: 30px;
            margin: 35px auto; /* Centered block with consistent spacing */
            max-width: 80%;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 42, 104, 0.15); /* Subtle red glow */
            line-height: 1.7; /* Improved readability */
        }

        /* Fact Section: Highlighted and impactful, drawing attention with electric energy */
        .fact {
            background-color: #0d0d0d; /* Slightly darker than other blocks for more emphasis */
            font-size: 34px;
            color: #00e0ff; /* A vibrant, electric cyan for a striking highlight */
            font-weight: 900;
            font-family: 'Rajdhani', sans-serif; /* A bold, modern sans-serif */
            text-align: center;
            padding: 40px; /* Generous padding for emphasis */
            margin: 35px auto; /* Centers the block */
            max-width: 85%; /* Ensures good presentation on various screen sizes */
            border-radius: 12px;
            box-shadow: 0 0 35px rgba(0, 224, 255, 0.8); /* Intense, bright cyan glow for "energy" */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth interaction on hover */
            will-change: transform, box-shadow; /* Hint to browser for performance optimization */
        }

        .fact:hover {
            transform: scale(1.02); /* Slight scale on hover for a dynamic feel */
            box-shadow: 0 0 50px rgba(0, 224, 255, 1); /* Even brighter, stronger glow on hover */
        }

        /* Tech Points List: Professional styling with custom glowing bullets */
        .tech_points {
            list-style-type: none; /* Removes default bullet points */
            padding: 25px; /* Ample internal spacing */
            margin: 30px auto; /* Centers the block horizontally, adds vertical spacing */
            max-width: 85%; /* Ensures readability on large screens, responsive on small */
            background-color: #1a1a1a; /* A deep charcoal for subtle depth against pure black */
            border-radius: 12px; /* Softly rounded corners for a modern feel */
            box-shadow: 0 0 20px rgba(255, 0, 80, 0.15); /* A subtle, outward glow matching the radiation theme */
            color: #dadada; /* Light grey text for excellent contrast */
            font-family: 'Audiowide', cursive;
            font-size: 20px;
            text-align: left; /* Best for list readability */
            line-height: 1.5; /* Improves text readability */
        }

        .tech_points li {
            padding: 15px 0; /* Vertical padding for each list item */
            border-bottom: 1px solid rgba(255, 255, 255, 0.08); /* A very subtle, transparent line separator */
            position: relative; /* Necessary for positioning the custom bullet point */
            padding-left: 35px; /* Creates space for the custom bullet */
            transition: background-color 0.3s ease, transform 0.2s ease; /* Smooth hover effects */
        }

        .tech_points li:last-child {
            border-bottom: none; /* No separator for the very last item */
        }

        /* Custom glowing bullet point for each list item */
        .tech_points li::before {
            content: ''; /* Required for pseudo-elements */
            position: absolute;
            left: 0; /* Aligns to the left of the padding-left */
            top: 50%;
            transform: translateY(-50%); /* Vertically centers the bullet */
            width: 10px; /* Size of the bullet */
            height: 10px;
            border-radius: 50%; /* Makes it a perfect circle */
            background: linear-gradient(45deg, #00e0ff, #0072ff); /* A cool, vibrant electric cyan gradient */
            box-shadow: 0 0 12px rgba(0, 224, 255, 0.8); /* A strong, matching glow around the bullet */
        }

        .tech_points li:hover {
            background-color: #1a1a1a; /* Slightly lighter black on hover for subtle interaction */
            transform: translateX(5px); /* A subtle slide-right effect on hover */
        }

        /* Solar Spectrum Visualization Specific Styles */
        .solar-visual-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 40px auto;
            max-width: 90%;
            background: #111111;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 42, 104, 0.15); /* Subtle red glow for visual containers */
            position: relative;
        }

        .solar-representation {
            width: 90%;
            max-width: 700px;
            height: 300px;
            background-color: #0d0d0d;
            border-radius: 10px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5); /* Inner shadow for depth */
        }

        #solar-canvas {
            background-color: transparent; /* Canvas background will be drawn by JS */
            display: block;
            width: 100%;
            height: 100%;
        }

        .property-display {
            font-family: 'Courier New', monospace;
            font-size: 24px;
            color: #00e0ff; /* Electric cyan for property display */
            text-shadow: 0 0 10px #00e0ff;
            margin-top: 15px;
            text-align: center;
        }

        .slider-container {
            width: 80%;
            max-width: 500px;
            margin-top: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .property-slider {
            width: 100%;
            -webkit-appearance: none;
            height: 10px;
            background: linear-gradient(to right, #666, #ff416c, #ffcc00); /* Gradient from dark to red to yellow */
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }

        .property-slider:hover {
            opacity: 1;
        }

        .property-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        .property-slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        /* Application examples grid */
        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px auto;
            max-width: 90%;
        }

        .app-item {
            background: #1a1a1a; /* Consistent dark background for app items */
            padding: 20px;
            border-radius: 10px;
            transition: transform 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 198, 255, 0.1); /* Subtle blue glow */
            cursor: pointer;
        }

        .app-item:hover {
            transform: scale(1.03) translateY(-5px); /* Slight lift and scale */
            background: #222222; /* Slightly lighter on hover */
            box-shadow: 0 8px 25px rgba(0, 198, 255, 0.4); /* More pronounced, lifted glow */
        }

        .app-icon {
            font-size: 40px;
            text-align: center;
            margin-bottom: 15px;
            color: #00e0ff; /* Electric cyan for icons */
            text-shadow: 0 0 10px rgba(0, 224, 255, 0.7); /* Glowing icon effect */
        }

        .app-title {
            font-family: 'Rajdhani', sans-serif;
            font-size: 22px;
            color: white;
            margin-bottom: 10px;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main_heading {
                font-size: 40px;
                padding: 30px;
            }
            .subtopics {
                font-size: 22px;
                padding: 12px 20px;
            }
            p, .def {
                font-size: 18px;
                padding: 15px;
                margin: 20px auto;
                max-width: 90%;
            }
            .fact {
                font-size: 28px;
                padding: 30px;
            }
            .tech_points {
                font-size: 18px;
                padding: 20px;
            }
            .tech_points li {
                padding-left: 30px;
            }
            .tech_points li::before {
                width: 8px;
                height: 8px;
            }
            .solar-representation {
                height: 250px;
            }
            .property-display {
                font-size: 20px;
            }
            .property-slider {
                height: 8px;
            }
            .property-slider::-webkit-slider-thumb, .property-slider::-moz-range-thumb {
                width: 20px;
                height: 20px;
            }
            .app-grid {
                grid-template-columns: 1fr;
            }
            .app-icon {
                font-size: 36px;
            }
            .app-title {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            .main_heading {
                font-size: 32px;
                padding: 20px;
            }
            .subtopics {
                font-size: 18px;
                padding: 10px 15px;
            }
            p, .def {
                font-size: 16px;
                padding: 12px;
                margin: 15px auto;
            }
            .fact {
                font-size: 24px;
                padding: 25px;
            }
            .tech_points {
                font-size: 16px;
                padding: 15px;
            }
            .tech_points li {
                padding-left: 25px;
            }
            .tech_points li::before {
                width: 6px;
                height: 6px;
            }
            .solar-representation {
                height: 200px;
            }
            .property-display {
                font-size: 18px;
            }
            .property-slider {
                height: 6px;
            }
            .property-slider::-webkit-slider-thumb, .property-slider::-moz-range-thumb {
                width: 18px;
                height: 18px;
            }
            .app-icon {
                font-size: 32px;
            }
            .app-title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>

    <div class="main_heading">Solar Spectrum and Irradiance</div>

    <div class="def">
        <p>The <b>Solar Spectrum</b> is the distribution of electromagnetic radiation emitted by the Sun across all wavelengths. It ranges from high-energy gamma rays and X-rays to ultraviolet, visible light, infrared, and radio waves.</p>
        <p><b>Solar Irradiance</b> is the power per unit area received from the Sun, measured in watts per square meter ($\text{W/m}^2$). It can refer to the irradiance outside Earth's atmosphere (extraterrestrial) or at the Earth's surface (terrestrial), which is affected by atmospheric absorption and scattering.</p>
    </div>

    <div class="subtopics">Key Characteristics and Atmospheric Effects</div>

    <div class="def">
        <ul class="tech_points">
            <li><b>Extraterrestrial Spectrum:</b> Approximates a blackbody spectrum at about 5800 K, with peak intensity in the visible light range.</li>
            <li><b>Atmospheric Filtering:</b> Earth's atmosphere significantly modifies the solar spectrum. Ozone ($\text{O}_3$) absorbs most UV radiation, water vapor ($\text{H}_2\text{O}$) and carbon dioxide ($\text{CO}_2$) absorb in the infrared, and scattering by air molecules (Rayleigh scattering) affects blue light.</li>
            <li><b>Air Mass (AM):</b> A measure of the optical path length through Earth's atmosphere. AM0 (zero air mass) is outside the atmosphere. AM1.5 is a standard for terrestrial solar energy calculations, representing sunlight passing through 1.5 times the atmospheric thickness (e.g., at a 48.2° angle from vertical).</li>
            <li><b>Direct vs. Diffuse Radiation:</b> Solar irradiance at the surface consists of direct sunlight and diffuse radiation (scattered by the atmosphere).</li>
        </ul>
    </div>

    <div class="subtopics">Interactive Solar Spectrum Attenuation</div>

    <div class="solar-visual-container">
        <h3>Atmospheric Attenuation of Solar Spectrum</h3>
        <div class="solar-representation">
            <canvas id="solar-canvas"></canvas>
        </div>
        <div class="property-display" id="attenuation-display">Atmospheric Attenuation: 50%</div>
        <div class="property-display" id="extraterrestrial-irradiance-display">Extraterrestrial Irradiance: 1361 W/m²</div>
        <div class="property-display" id="terrestrial-irradiance-display">Terrestrial Irradiance: 680.5 W/m²</div>
        <div class="slider-container">
            <input type="range" min="0" max="100" value="50" class="property-slider" id="attenuation-slider">
            <span>Adjust Atmospheric Attenuation (%)</span>
        </div>
        <p>Observe how increasing the "Atmospheric Attenuation" reduces the amount of solar radiation reaching the "Earth's Surface." The "atmosphere" layer becomes denser, absorbing and scattering more incoming "solar particles," thus lowering the terrestrial irradiance.</p>
    </div>

    <div class="fact">
        DID YOU KNOW? The average solar irradiance at the top of Earth's atmosphere (the solar constant) is approximately 1361 $\text{W/m}^2$, but only about 1000 $\text{W/m}^2$ reaches the surface on a clear day at sea level due to atmospheric effects!
    </div>

    <div class="subtopics">Applications of Solar Spectrum and Irradiance</div>

    <div class="def">
        <ul class="tech_points">
            <li><b>Solar Energy Systems:</b> Critical for designing and optimizing photovoltaic panels and solar thermal collectors, requiring knowledge of available terrestrial irradiance.</li>
            <li><b>Climate Science:</b> Understanding the Earth's energy budget and the impact of atmospheric composition on global temperatures.</li>
            <li><b>Architecture and Building Design:</b> Optimizing building orientation, window placement, and shading to maximize daylighting and minimize unwanted heat gain.</li>
            <li><b>Agriculture:</b> Assessing light availability for crop growth and optimizing greenhouse designs.</li>
            <li><b>Space Exploration:</b> Designing spacecraft and instruments to withstand and utilize solar radiation in different orbital environments.</li>
            <li><b>Remote Sensing:</b> Calibrating satellite sensors by accounting for atmospheric effects on solar radiation.</li>
        </ul>
    </div>

    <div class="app-grid">
        <div class="app-item">
            <div class="app-icon">⚡</div>
            <div class="app-title">Solar Panels</div>
            <p>Maximizing electricity generation from sunlight.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🌡️</div>
            <div class="app-title">Climate Models</div>
            <p>Predicting global temperature changes and energy balance.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🏡</div>
            <div class="app-title">Green Building</div>
            <p>Designing energy-efficient structures using natural light.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🌾</div>
            <div class="app-title">Crop Optimization</div>
            <p>Ensuring sufficient light for plant photosynthesis.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🚀</div>
            <div class="app-title">Spacecraft Design</div>
            <p>Thermal control and power generation in space.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🗺️</div>
            <div class="app-title">Weather Forecasting</div>
            <p>Atmospheric radiation impacts weather patterns.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('solar-canvas');
            const ctx = canvas.getContext('2d');
            const attenuationSlider = document.getElementById('attenuation-slider');
            const attenuationDisplay = document.getElementById('attenuation-display');
            const extraterrestrialIrradianceDisplay = document.getElementById('extraterrestrial-irradiance-display');
            const terrestrialIrradianceDisplay = document.getElementById('terrestrial-irradiance-display');

            // Set canvas dimensions to match its container
            const setCanvasDimensions = () => {
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                particles = []; // Clear particles on resize
                drawSolarScene(); // Redraw on resize
            };

            // Particle properties (representing solar photons)
            const particleRadius = 2;
            const particleColor = '#ffcc00'; // Yellow/orange for solar radiation
            const particleSpeed = 3;
            const maxParticles = 180; // Max particles visible at once
            let particles = [];

            // Atmospheric layer properties
            const atmosphereWidth = canvas.width * 0.4;
            const atmosphereX = canvas.width * 0.3; // Centered atmosphere layer
            const atmosphereColorBase = 'rgba(0, 198, 255, 0.05)'; // Very faint blue for atmosphere
            const atmosphereGlowColor = 'rgba(0, 198, 255, 0.5)'; // Blue glow for atmosphere

            // Irradiance values (simplified for visualization)
            const solarConstant = 1361; // W/m^2 - approximate extraterrestrial irradiance
            let terrestrialIrradiance = solarConstant;

            // Animation loop
            let animationFrameId;

            function createParticle() {
                // Particles originate from the left edge (Sun), randomly along Y
                return {
                    x: 0,
                    y: Math.random() * canvas.height,
                    vx: particleSpeed + Math.random() * 0.5, // Slight speed variation
                    vy: (Math.random() - 0.5) * 0.5, // Slight vertical drift
                    active: true, // Particle is currently active
                    passedAtmosphere: false // To track if it passed the atmosphere
                };
            }

            function updateParticles() {
                const attenuationEffect = parseFloat(attenuationSlider.value) / 100; // 0 to 1

                // Filter out inactive particles
                particles = particles.filter(p => p.active);

                // Add new incoming particles from source (left side)
                if (particles.filter(p => p.x < atmosphereX).length < maxParticles / 2 && Math.random() < 0.8) {
                    particles.push(createParticle());
                }

                let particlesReachedSurface = 0;
                let particlesAtTop = 0; // Count particles before atmosphere

                for (let i = 0; i < particles.length; i++) {
                    const p = particles[i];

                    p.x += p.vx;
                    p.y += p.vy;

                    // Bounce off top/bottom edges
                    if (p.y < 0 || p.y > canvas.height) {
                        p.vy *= -1;
                    }

                    // Count particles at the "top of atmosphere" (just before it)
                    if (p.x >= atmosphereX - particleSpeed && p.x < atmosphereX && !p.countedAtTop) {
                        particlesAtTop++;
                        p.countedAtTop = true; // Mark as counted to avoid double counting
                    }

                    // Check interaction with atmosphere layer
                    if (p.x >= atmosphereX && p.x <= atmosphereX + atmosphereWidth && p.active && !p.passedAtmosphere) {
                        // Particle is within the atmosphere layer
                        if (Math.random() < attenuationEffect) { // Probability of absorption/scattering increases with attenuation
                            p.active = false; // Particle absorbed/scattered
                            continue; // Skip to next particle
                        } else {
                            p.passedAtmosphere = true; // Mark as passed
                        }
                    }

                    // If particle reached the "surface" (right side)
                    if (p.x > canvas.width * 0.9 && p.active) {
                        particlesReachedSurface++;
                    }

                    // Remove particles that go off screen
                    if (p.x > canvas.width + particleRadius || p.x < -particleRadius || p.y > canvas.height + particleRadius || p.y < -particleRadius) {
                        p.active = false;
                    }
                }

                // Update irradiance displays (simplified based on particle counts)
                // Extraterrestrial Irradiance is constant
                extraterrestrialIrradianceDisplay.textContent = `Extraterrestrial Irradiance: ${solarConstant.toFixed(0)} W/m²`;

                // Terrestrial Irradiance is reduced by attenuation
                terrestrialIrradiance = solarConstant * (1 - attenuationEffect);
                terrestrialIrradianceDisplay.textContent = `Terrestrial Irradiance: ${terrestrialIrradiance.toFixed(1)} W/m²`;
            }

            function drawSolarScene() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const attenuationEffect = parseFloat(attenuationSlider.value) / 100; // 0 to 1

                // Draw Sun (left side)
                ctx.fillStyle = 'rgba(255, 200, 0, 0.8)'; // Yellow sun
                ctx.beginPath();
                ctx.arc(canvas.width * 0.08, canvas.height / 2, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowColor = 'rgba(255, 200, 0, 1)';
                ctx.shadowBlur = 15;
                ctx.font = '20px "Rajdhani", sans-serif';
                ctx.fillStyle = '#ffffff';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('Sun', canvas.width * 0.08, canvas.height / 2 + 40);
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Earth's Surface (right side)
                ctx.fillStyle = 'rgba(0, 150, 0, 0.8)'; // Green Earth
                ctx.beginPath();
                ctx.rect(canvas.width * 0.9, 0, canvas.width * 0.1, canvas.height);
                ctx.fill();
                ctx.shadowColor = 'rgba(0, 150, 0, 1)';
                ctx.shadowBlur = 20;
                ctx.fillStyle = '#ffffff';
                ctx.fillText('Surface', canvas.width * 0.95, canvas.height / 2);
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Atmosphere Layer
                const atmosphereHeight = canvas.height * 0.9;
                const atmosphereY = (canvas.height - atmosphereHeight) / 2;

                // Adjust atmosphere color/glow based on attenuation
                const atmosphereOpacity = 0.05 + (attenuationEffect * 0.3); // From 0.05 (faint) to 0.35 (more visible)
                const atmosphereColor = `rgba(0, 198, 255, ${atmosphereOpacity})`; // Blueish for atmosphere
                ctx.fillStyle = atmosphereColor;
                ctx.fillRect(atmosphereX, atmosphereY, atmosphereWidth, atmosphereHeight);

                // Add a glow to the atmosphere layer (simulating scattering/absorption)
                const glowIntensity = attenuationEffect * 15; // 0 to 15px blur
                ctx.shadowColor = atmosphereGlowColor;
                ctx.shadowBlur = glowIntensity;
                ctx.fillRect(atmosphereX, atmosphereY, atmosphereWidth, atmosphereHeight); // Redraw to apply shadow
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Particles
                particles.forEach(p => {
                    if (p.active) {
                        ctx.fillStyle = p.color;
                        ctx.shadowColor = p.color;
                        ctx.shadowBlur = 5; // Particle glow
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, particleRadius, 0, Math.PI * 2);
                        ctx.fill();
                    }
                });
                ctx.shadowBlur = 0; // Reset particle shadow

                // Update display text for attenuation
                attenuationDisplay.textContent = `Atmospheric Attenuation: ${attenuationSlider.value}%`;

                animationFrameId = requestAnimationFrame(drawSolarScene);
                updateParticles(); // Update particle positions and logic
            }

            // Event listener for slider
            attenuationSlider.addEventListener('input', () => {
                // When slider changes, immediately update display
                attenuationDisplay.textContent = `Atmospheric Attenuation: ${attenuationSlider.value}%`;
                // Reset particles to restart simulation with new settings
                particles = [];
            });

            // Initial setup
            setCanvasDimensions();
            window.addEventListener('resize', setCanvasDimensions);

            // Start animation loop
            animationFrameId = requestAnimationFrame(drawSolarScene);
        });
    </script>

</body>
</html>
