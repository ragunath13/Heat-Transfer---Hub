<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectral Nature and Band Models</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Audiowide|Rajdhani|Courier+New">
    <style>
        /* Base styles: Ensuring a deep, consistent black background */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box; /* Includes padding and border in the element's total width and height */
            /* Default background for elements unless specified - slightly off-black for depth */
            background-color: #0a0a0a;
        }

        body {
            background-color: #000000; /* Pure black for the main page background */
            font-family: 'Audiowide', cursive; /* Keeping the distinct, futuristic font */
            color: #d3d3d3; /* A standard light grey for excellent readability on dark backgrounds */
            line-height: 1.6; /* Improves readability of text blocks */
            overflow-x: hidden; /* Prevent horizontal scroll on some subtle effects */
        }

        /* Main Heading: Bold and energetic, central to the radiation theme */
        .main_heading {
            background: linear-gradient(to right, #f40166, #ff2a68, #ff0000); /* Vibrant red/pink/orange gradient */
            font-size: 50px; /* Consistent size for prominence */
            font-family: 'Courier New', monospace; /* A classic techy font */
            font-weight: 900; /* Extra bold for impact */
            color: #000000; /* Black text creates strong contrast on the gradient */
            text-align: center;
            padding: 50px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(255, 110, 110, 0.7); /* Stronger, more defined glowing red shadow */
            margin: 30px auto; /* Centers the block and adds vertical spacing */
            max-width: 90%; /* Ensures responsiveness and readability on larger screens */
            will-change: box-shadow; /* Hint to browser for performance optimization */
        }

        /* General Paragraphs: Clean and readable, designed for content */
        p {
            font-size: 22px;
            font-family: 'Audiowide', cursive;
            text-align: center; /* Centered text within paragraphs */
            padding: 20px;
            margin: 25px auto; /* Centers the block and provides vertical spacing */
            max-width: 80%; /* Limits paragraph width for better readability */
            background-color: #1a1a1a; /* Slightly lighter charcoal for subtle visual distinction */
            border-radius: 10px;
            color: #b7b8b8; /* A muted grey for standard text */
            box-shadow: 0 0 8px rgba(255, 42, 104, 0.1); /* Very subtle, understated red glow */
            line-height: 1.7; /* Further improved readability */
        }

        /* Subtopic Headings: Consistent with the main radiation theme's subtopics */
        .subtopics {
            background-image: linear-gradient(58.2deg, rgba(255, 76, 10, 0.9) -3%, rgba(255, 0, 80, 0.8) 49.3%, rgba(255, 200, 0, 0.8) 97.7%); /* Intense, mixed-tone gradient */
            font-size: 28px;
            color: #ffffff;
            font-family: 'Audiowide', cursive;
            font-weight: bold;
            padding: 25px 40px;
            margin: 35px auto; /* Centered with generous spacing */
            max-width: 80%;
            text-align: center;
            border-radius: 15px; /* Softer radius for a less rigid feel */
            border: 2px solid #ff416c; /* A clear, vibrant red border */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            transition: all 0.4s ease; /* All-encompassing smooth transition */
            will-change: transform, box-shadow, background;
            cursor: pointer;
        }

        .subtopics:hover {
            transform: scale(1.03) translateY(-3px); /* More noticeable lift and scale */
            background-image: linear-gradient(58.2deg, rgba(255, 0, 80, 0.95) -3%, rgba(255, 76, 10, 0.95) 49.3%, rgba(255, 200, 0, 0.95) 97.7%); /* Even more intense gradient on hover */
            color: #000000; /* Black text for strong contrast on hover */
            box-shadow: 0 0 45px rgba(255, 0, 80, 0.9); /* Enhanced, stronger glow on hover */
        }

        /* Definition Section: Standard content block with clear typography */
        .def {
            background-color: #111111; /* Consistent dark background */
            font-family: 'Audiowide', cursive;
            font-size: 22px; /* Consistent with general paragraphs */
            color: #b7b8b8;
            font-weight: normal; /* Standard weight for content, avoiding excessive boldness */
            text-align: center;
            padding: 30px;
            margin: 35px auto; /* Centered block with consistent spacing */
            max-width: 80%;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 42, 104, 0.15); /* Subtle red glow */
            line-height: 1.7; /* Improved readability */
        }

        /* Fact Section: Highlighted and impactful, drawing attention with electric energy */
        .fact {
            background-color: #0d0d0d; /* Slightly darker than other blocks for more emphasis */
            font-size: 34px;
            color: #00e0ff; /* A vibrant, electric cyan for a striking highlight */
            font-weight: 900;
            font-family: 'Rajdhani', sans-serif; /* A bold, modern sans-serif */
            text-align: center;
            padding: 40px; /* Generous padding for emphasis */
            margin: 35px auto; /* Centers the block */
            max-width: 85%; /* Ensures good presentation on various screen sizes */
            border-radius: 12px;
            box-shadow: 0 0 35px rgba(0, 224, 255, 0.8); /* Intense, bright cyan glow for "energy" */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth interaction on hover */
            will-change: transform, box-shadow; /* Hint to browser for performance optimization */
        }

        .fact:hover {
            transform: scale(1.02); /* Slight scale on hover for a dynamic feel */
            box-shadow: 0 0 50px rgba(0, 224, 255, 1); /* Even brighter, stronger glow on hover */
        }

        /* Tech Points List: Professional styling with custom glowing bullets */
        .tech_points {
            list-style-type: none; /* Removes default bullet points */
            padding: 25px; /* Ample internal spacing */
            margin: 30px auto; /* Centers the block horizontally, adds vertical spacing */
            max-width: 85%; /* Ensures readability on large screens, responsive on small */
            background-color: #1a1a1a; /* A deep charcoal for subtle depth against pure black */
            border-radius: 12px; /* Softly rounded corners for a modern feel */
            box-shadow: 0 0 20px rgba(255, 0, 80, 0.15); /* A subtle, outward glow matching the radiation theme */
            color: #dadada; /* Light grey text for excellent contrast */
            font-family: 'Audiowide', cursive;
            font-size: 20px;
            text-align: left; /* Best for list readability */
            line-height: 1.5; /* Improves text readability */
        }

        .tech_points li {
            padding: 15px 0; /* Vertical padding for each list item */
            border-bottom: 1px solid rgba(255, 255, 255, 0.08); /* A very subtle, transparent line separator */
            position: relative; /* Necessary for positioning the custom bullet point */
            padding-left: 35px; /* Creates space for the custom bullet */
            transition: background-color 0.3s ease, transform 0.2s ease; /* Smooth hover effects */
        }

        .tech_points li:last-child {
            border-bottom: none; /* No separator for the very last item */
        }

        /* Custom glowing bullet point for each list item */
        .tech_points li::before {
            content: ''; /* Required for pseudo-elements */
            position: absolute;
            left: 0; /* Aligns to the left of the padding-left */
            top: 50%;
            transform: translateY(-50%); /* Vertically centers the bullet */
            width: 10px; /* Size of the bullet */
            height: 10px;
            border-radius: 50%; /* Makes it a perfect circle */
            background: linear-gradient(45deg, #00e0ff, #0072ff); /* A cool, vibrant electric cyan gradient */
            box-shadow: 0 0 12px rgba(0, 224, 255, 0.8); /* A strong, matching glow around the bullet */
        }

        .tech_points li:hover {
            background-color: #1a1a1a; /* Slightly lighter black on hover for subtle interaction */
            transform: translateX(5px); /* A subtle slide-right effect on hover */
        }

        /* Spectral Visualization Specific Styles */
        .spectral-visual-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 40px auto;
            max-width: 90%;
            background: #111111;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 42, 104, 0.15); /* Subtle red glow for visual containers */
            position: relative;
        }

        .spectral-representation {
            width: 90%;
            max-width: 700px;
            height: 300px;
            background-color: #0d0d0d;
            border-radius: 10px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5); /* Inner shadow for depth */
        }

        #spectral-canvas {
            background-color: transparent; /* Canvas background will be drawn by JS */
            display: block;
            width: 100%;
            height: 100%;
        }

        .property-display {
            font-family: 'Courier New', monospace;
            font-size: 24px;
            color: #00e0ff; /* Electric cyan for property display */
            text-shadow: 0 0 10px #00e0ff;
            margin-top: 15px;
            text-align: center;
        }

        .slider-container {
            width: 80%;
            max-width: 500px;
            margin-top: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .property-slider {
            width: 100%;
            -webkit-appearance: none;
            height: 10px;
            background: linear-gradient(to right, #666, #ff416c, #ffcc00); /* Gradient from dark to red to yellow */
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }

        .property-slider:hover {
            opacity: 1;
        }

        .property-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        .property-slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        /* Application examples grid */
        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px auto;
            max-width: 90%;
        }

        .app-item {
            background: #1a1a1a; /* Consistent dark background for app items */
            padding: 20px;
            border-radius: 10px;
            transition: transform 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 198, 255, 0.1); /* Subtle blue glow */
            cursor: pointer;
        }

        .app-item:hover {
            transform: scale(1.03) translateY(-5px); /* Slight lift and scale */
            background: #222222; /* Slightly lighter on hover */
            box-shadow: 0 8px 25px rgba(0, 198, 255, 0.4); /* More pronounced, lifted glow */
        }

        .app-icon {
            font-size: 40px;
            text-align: center;
            margin-bottom: 15px;
            color: #00e0ff; /* Electric cyan for icons */
            text-shadow: 0 0 10px rgba(0, 224, 255, 0.7); /* Glowing icon effect */
        }

        .app-title {
            font-family: 'Rajdhani', sans-serif;
            font-size: 22px;
            color: white;
            margin-bottom: 10px;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main_heading {
                font-size: 40px;
                padding: 30px;
            }
            .subtopics {
                font-size: 22px;
                padding: 12px 20px;
            }
            p, .def {
                font-size: 18px;
                padding: 15px;
                margin: 20px auto;
                max-width: 90%;
            }
            .fact {
                font-size: 28px;
                padding: 30px;
            }
            .tech_points {
                font-size: 18px;
                padding: 20px;
            }
            .tech_points li {
                padding-left: 30px;
            }
            .tech_points li::before {
                width: 8px;
                height: 8px;
            }
            .spectral-representation {
                height: 250px;
            }
            .property-display {
                font-size: 20px;
            }
            .property-slider {
                height: 8px;
            }
            .property-slider::-webkit-slider-thumb, .property-slider::-moz-range-thumb {
                width: 20px;
                height: 20px;
            }
            .app-grid {
                grid-template-columns: 1fr;
            }
            .app-icon {
                font-size: 36px;
            }
            .app-title {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            .main_heading {
                font-size: 32px;
                padding: 20px;
            }
            .subtopics {
                font-size: 18px;
                padding: 10px 15px;
            }
            p, .def {
                font-size: 16px;
                padding: 12px;
                margin: 15px auto;
            }
            .fact {
                font-size: 24px;
                padding: 25px;
            }
            .tech_points {
                font-size: 16px;
                padding: 15px;
            }
            .tech_points li {
                padding-left: 25px;
            }
            .tech_points li::before {
                width: 6px;
                height: 6px;
            }
            .spectral-representation {
                height: 200px;
            }
            .property-display {
                font-size: 18px;
            }
            .property-slider {
                height: 6px;
            }
            .property-slider::-webkit-slider-thumb, .property-slider::-moz-range-thumb {
                width: 18px;
                height: 18px;
            }
            .app-icon {
                font-size: 32px;
            }
            .app-title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>

    <div class="main_heading">Spectral Nature and Band Models</div>

    <div class="def">
        <p>The <b>Spectral Nature</b> of radiation refers to its composition across different wavelengths or frequencies. For gases, absorption and emission of radiation do not occur uniformly across all wavelengths but are concentrated in specific, narrow regions known as <b>spectral bands</b>.</p>
        <p><b>Band Models</b> are simplified mathematical representations used to describe the complex spectral absorption and emission properties of gases over these bands, making radiative heat transfer calculations feasible in engineering and atmospheric sciences.</p>
    </div>

    <div class="subtopics">Understanding Spectral Bands</div>

    <div class="def">
        <ul class="tech_points">
            <li><b>Molecular Fingerprints:</b> Each gas molecule ($\text{CO}_2$, $\text{H}_2\text{O}$, etc.) has unique vibrational and rotational energy levels. Transitions between these levels correspond to the absorption or emission of photons at specific, discrete wavelengths.</li>
            <li><b>Line Spectra vs. Bands:</b> While individual transitions create very narrow "spectral lines," broadening effects (due to collisions, Doppler effect) cause these lines to merge into wider "bands" at typical temperatures and pressures.</li>
            <li><b>Infrared Dominance:</b> For $\text{CO}_2$ and $\text{H}_2\text{O}$, these significant bands are primarily in the infrared region of the electromagnetic spectrum, which is crucial for thermal radiation.</li>
            <li><b>Selective Absorption/Emission:</b> Gases are strong absorbers/emitters only within these specific bands, and largely transparent outside them.</li>
        </ul>
    </div>

    <div class="subtopics">Interactive Spectral Band Demonstration</div>

    <div class="spectral-visual-container">
        <h3>Gas Interaction with Spectral Bands</h3>
        <div class="spectral-representation">
            <canvas id="spectral-canvas"></canvas>
        </div>
        <div class="property-display" id="spectral-complexity-display">Spectral Interaction Complexity: 50%</div>
        <div class="property-display" id="absorbed-count-display">Absorbed: 0</div>
        <div class="property-display" id="emitted-count-display">Emitted: 0</div>
        <div class="slider-container">
            <input type="range" min="0" max="100" value="50" class="property-slider" id="complexity-slider">
            <span>Adjust Spectral Interaction Complexity (%)</span>
        </div>
        <p>Observe how increasing the "Spectral Interaction Complexity" activates more or broader absorption/emission bands within the gas layer. Incoming "radiation particles" (represented by varying vertical positions/colors) are selectively absorbed within these bands, and new "thermal particles" are emitted from the gas.</p>
    </div>

    <div class="fact">
        DID YOU KNOW? Without the spectral absorption and emission of infrared radiation by greenhouse gases, Earth's average surface temperature would be about -18°C (0°F) instead of a comfortable 15°C (59°F)!
    </div>

    <div class="subtopics">Applications of Spectral Nature and Band Models</div>

    <div class="def">
        <ul class="tech_points">
            <li><b>Atmospheric Radiative Transfer:</b> Essential for climate models, weather forecasting, and understanding the greenhouse effect, as it dictates how radiation moves through the atmosphere.</li>
            <li><b>Combustion Diagnostics:</b> Analyzing the spectral emission from flames to determine temperature, species concentration, and combustion efficiency.</li>
            <li><b>Remote Sensing:</b> Satellites use specific spectral bands to identify atmospheric gases, monitor pollution, and measure surface temperatures.</li>
            <li><b>Infrared Heating:</b> Designing infrared heaters that emit radiation in bands effectively absorbed by the target material (e.g., water in food).</li>
            <li><b>Optical Gas Sensors:</b> Devices that detect specific gases by measuring their unique absorption patterns in the infrared spectrum.</li>
            <li><b>Thermal Management:</b> In high-temperature industrial processes, understanding gas radiation is critical for efficient heat recovery and process control.</li>
        </ul>
    </div>

    <div class="app-grid">
        <div class="app-item">
            <div class="app-icon">🌍</div>
            <div class="app-title">Climate Modeling</div>
            <p>Simulating atmospheric heat balance for climate predictions.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🔥</div>
            <div class="app-title">Combustion Analysis</div>
            <p>Studying flame properties through spectral emission.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🛰️</div>
            <div class="app-title">Environmental Monitoring</div>
            <p>Detecting pollutants and greenhouse gases from space.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">♨️</div>
            <div class="app-title">Industrial Furnaces</div>
            <p>Optimizing radiant heat transfer in high-temperature processes.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">🧪</div>
            <div class="app-title">Gas Spectroscopy</div>
            <p>Identifying and quantifying gases based on their unique spectra.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">☀️</div>
            <div class="app-title">Solar Energy Systems</div>
            <p>Designing selective absorbers and transparent covers.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('spectral-canvas');
            const ctx = canvas.getContext('2d');
            const complexitySlider = document.getElementById('complexity-slider');
            const spectralComplexityDisplay = document.getElementById('spectral-complexity-display');
            const absorbedCountDisplay = document.getElementById('absorbed-count-display');
            const emittedCountDisplay = document.getElementById('emitted-count-display');

            // Set canvas dimensions to match its container
            const setCanvasDimensions = () => {
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                particles = []; // Clear particles on resize
                absorbedCount = 0;
                emittedCount = 0;
                drawSpectralScene(); // Redraw on resize
            };

            // Particle properties
            const particleRadius = 2;
            const incomingParticleColor = '#ffcc00'; // Yellow/orange for incoming broad spectrum radiation
            const emittedParticleColor = '#ff416c'; // Red/pink for emitted thermal radiation
            const particleSpeed = 2;
            const maxParticles = 150; // Max particles visible at once
            let particles = [];

            // Gas layer properties
            const gasLayerWidth = canvas.width * 0.5;
            const gasLayerX = canvas.width * 0.25; // Centered gas layer
            const gasColorBase = 'rgba(0, 198, 255, 0.05)'; // Very faint blue for gas
            const gasGlowColor = 'rgba(0, 198, 255, 0.5)'; // Blue glow for gas

            // Spectral band definitions (y-coordinates represent 'wavelength' regions)
            // Each band has a center Y, a height, and a base absorption/emission probability
            const spectralBands = [
                { y: 0.15, height: 0.08, baseProb: 0.04 }, // Band 1
                { y: 0.35, height: 0.12, baseProb: 0.06 }, // Band 2
                { y: 0.60, height: 0.10, baseProb: 0.05 }, // Band 3
                { y: 0.80, height: 0.07, baseProb: 0.03 }  // Band 4
            ];

            let absorbedCount = 0;
            let emittedCount = 0;

            // Animation loop
            let animationFrameId;

            function createParticle(type, originX) {
                const isIncoming = (type === 'incoming');
                return {
                    x: isIncoming ? originX : gasLayerX + Math.random() * gasLayerWidth,
                    y: Math.random() * canvas.height, // Random Y for incoming, or within gas for emitted
                    vx: isIncoming ? particleSpeed + (Math.random() - 0.5) * 0.5 : (Math.random() - 0.5) * particleSpeed * 1.5, // Emitted particles can go any direction
                    vy: (Math.random() - 0.5) * particleSpeed * 0.8,
                    color: isIncoming ? incomingParticleColor : emittedParticleColor,
                    type: type,
                    active: true
                };
            }

            function updateParticles() {
                const complexityEffect = parseFloat(complexitySlider.value) / 100; // 0 to 1

                // Filter out inactive particles
                particles = particles.filter(p => p.active);

                // Add new incoming particles from source (left side)
                if (particles.filter(p => p.type === 'incoming').length < maxParticles / 2 && Math.random() < 0.8) {
                    particles.push(createParticle('incoming', 0));
                }

                // Add new thermal particles emitted by the gas (emission increases with complexity)
                // Emission occurs within active bands
                spectralBands.forEach(band => {
                    const bandCenterY = canvas.height * band.y;
                    const bandHeightPx = canvas.height * band.height;
                    const bandTop = bandCenterY - bandHeightPx / 2;
                    const bandBottom = bandCenterY + bandHeightPx / 2;

                    // Emission rate influenced by complexity and band's base probability
                    if (Math.random() < band.baseProb * complexityEffect * 5) { // Scale emission by complexity
                        const emittedY = bandTop + Math.random() * bandHeightPx;
                        const newParticle = createParticle('emitted');
                        newParticle.y = emittedY; // Ensure emitted particle starts within the band
                        particles.push(newParticle);
                        emittedCount++;
                    }
                });


                for (let i = 0; i < particles.length; i++) {
                    const p = particles[i];

                    p.x += p.vx;
                    p.y += p.vy;

                    // Bounce off top/bottom edges
                    if (p.y < 0 || p.y > canvas.height) {
                        p.vy *= -1;
                    }

                    // Check interaction with gas layer and spectral bands
                    if (p.x >= gasLayerX && p.x <= gasLayerX + gasLayerWidth && p.active) {
                        // Particle is within the gas layer
                        let inActiveBand = false;
                        for (const band of spectralBands) {
                            const bandCenterY = canvas.height * band.y;
                            const bandHeightPx = canvas.height * band.height;
                            const bandTop = bandCenterY - bandHeightPx / 2;
                            const bandBottom = bandCenterY + bandHeightPx / 2;

                            if (p.y >= bandTop && p.y <= bandBottom) {
                                inActiveBand = true;
                                if (p.type === 'incoming' && Math.random() < band.baseProb * complexityEffect * 2) { // Absorption probability scaled by complexity
                                    p.active = false; // Incoming particle absorbed by gas
                                    absorbedCount++;
                                    break; // Stop checking further bands for this particle
                                }
                                // Scattering effect within bands
                                if (complexityEffect > 0 && Math.random() < complexityEffect * 0.01) {
                                    p.vx += (Math.random() - 0.5) * 0.2;
                                    p.vy += (Math.random() - 0.5) * 0.2;
                                }
                            }
                        }
                    }

                    // Remove particles that go off screen
                    if (p.x > canvas.width + particleRadius || p.x < -particleRadius || p.y > canvas.height + particleRadius || p.y < -particleRadius) {
                        p.active = false;
                    }
                }

                // Update displays
                absorbedCountDisplay.textContent = `Absorbed: ${absorbedCount}`;
                emittedCountDisplay.textContent = `Emitted: ${emittedCount}`;
            }

            function drawSpectralScene() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const complexityEffect = parseFloat(complexitySlider.value) / 100; // 0 to 1

                // Draw Source (left side)
                ctx.fillStyle = 'rgba(255, 200, 0, 0.8)'; // Yellow source
                ctx.beginPath();
                ctx.arc(canvas.width * 0.08, canvas.height / 2, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowColor = 'rgba(255, 200, 0, 1)';
                ctx.shadowBlur = 15;
                ctx.font = '20px "Rajdhani", sans-serif';
                ctx.fillStyle = '#ffffff';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('Source', canvas.width * 0.08, canvas.height / 2 + 40);
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Detector (right side)
                ctx.fillStyle = 'rgba(0, 150, 0, 0.8)'; // Green detector
                ctx.beginPath();
                ctx.rect(canvas.width * 0.9, 0, canvas.width * 0.1, canvas.height);
                ctx.fill();
                ctx.shadowColor = 'rgba(0, 150, 0, 1)';
                ctx.shadowBlur = 20;
                ctx.fillStyle = '#ffffff';
                ctx.fillText('Detector', canvas.width * 0.95, canvas.height / 2);
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Gas Layer (Atmosphere/Medium)
                const gasLayerHeight = canvas.height * 0.9;
                const gasLayerY = (canvas.height - gasLayerHeight) / 2;

                // Adjust gas layer color/glow based on complexity
                const gasOpacity = 0.05 + (complexityEffect * 0.2); // From 0.05 (faint) to 0.25 (more visible)
                const gasColor = `rgba(0, 198, 255, ${gasOpacity})`; // Blueish for gas
                ctx.fillStyle = gasColor;
                ctx.fillRect(gasLayerX, gasLayerY, gasLayerWidth, gasLayerHeight);

                // Add a glow to the gas layer (simulating overall thermal activity)
                const glowIntensity = complexityEffect * 15; // 0 to 15px blur
                ctx.shadowColor = gasGlowColor;
                ctx.shadowBlur = glowIntensity;
                ctx.fillRect(gasLayerX, gasLayerY, gasLayerWidth, gasLayerHeight); // Redraw to apply shadow
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Spectral Bands within the gas layer
                spectralBands.forEach(band => {
                    const bandCenterY = canvas.height * band.y;
                    const bandHeightPx = canvas.height * band.height;
                    const bandTop = bandCenterY - bandHeightPx / 2;

                    // Opacity of band visualization increases with complexity
                    const bandVizOpacity = complexityEffect * 0.4; // From 0 to 0.4
                    ctx.fillStyle = `rgba(255, 0, 80, ${bandVizOpacity})`; // Reddish for bands
                    ctx.fillRect(gasLayerX, bandTop, gasLayerWidth, bandHeightPx);
                    
                    // Add a subtle glow to the bands
                    ctx.shadowColor = `rgba(255, 0, 80, ${complexityEffect * 0.8})`;
                    ctx.shadowBlur = complexityEffect * 10;
                    ctx.fillRect(gasLayerX, bandTop, gasLayerWidth, bandHeightPx); // Redraw for shadow
                    ctx.shadowBlur = 0; // Reset shadow
                });


                // Draw Particles
                particles.forEach(p => {
                    if (p.active) {
                        ctx.fillStyle = p.color;
                        ctx.shadowColor = p.color;
                        ctx.shadowBlur = 5; // Particle glow
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, particleRadius, 0, Math.PI * 2);
                        ctx.fill();
                    }
                });
                ctx.shadowBlur = 0; // Reset particle shadow

                // Update display text for spectral complexity
                spectralComplexityDisplay.textContent = `Spectral Interaction Complexity: ${complexitySlider.value}%`;

                animationFrameId = requestAnimationFrame(drawSpectralScene);
                updateParticles(); // Update particle positions and logic
            }

            // Event listener for slider
            complexitySlider.addEventListener('input', () => {
                // When slider changes, immediately update display
                spectralComplexityDisplay.textContent = `Spectral Interaction Complexity: ${complexitySlider.value}%`;
                // Reset counts and particles to restart simulation with new settings
                absorbedCount = 0;
                emittedCount = 0;
                particles = [];
            });

            // Initial setup
            setCanvasDimensions();
            window.addEventListener('resize', setCanvasDimensions);

            // Start animation loop
            animationFrameId = requestAnimationFrame(drawSpectralScene);
        });
    </script>

</body>
</html>
