<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atmospheric Attenuation of Radiation</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Audiowide|Rajdhani|Courier+New">
    <style>
        /* Base styles: Ensuring a deep, consistent black background */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box; /* Includes padding and border in the element's total width and height */
            /* Default background for elements unless specified - slightly off-black for depth */
            background-color: #0a0a0a;
        }

        body {
            background-color: #000000; /* Pure black for the main page background */
            font-family: 'Audiowide', cursive; /* Keeping the distinct, futuristic font */
            color: #d3d3d3; /* A standard light grey for excellent readability on dark backgrounds */
            line-height: 1.6; /* Improves readability of text blocks */
            overflow-x: hidden; /* Prevent horizontal scroll on some subtle effects */
        }

        /* Main Heading: Bold and energetic, central to the radiation theme */
        .main_heading {
            background: linear-gradient(to right, #f40166, #ff2a68, #ff0000); /* Vibrant red/pink/orange gradient */
            font-size: 50px; /* Consistent size for prominence */
            font-family: 'Courier New', monospace; /* A classic techy font */
            font-weight: 900; /* Extra bold for impact */
            color: #000000; /* Black text creates strong contrast on the gradient */
            text-align: center;
            padding: 50px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(255, 110, 110, 0.7); /* Stronger, more defined glowing red shadow */
            margin: 30px auto; /* Centers the block and adds vertical spacing */
            max-width: 90%; /* Ensures responsiveness and readability on larger screens */
            will-change: box-shadow; /* Hint to browser for performance optimization */
        }

        /* General Paragraphs: Clean and readable, designed for content */
        p {
            font-size: 22px;
            font-family: 'Audiowide', cursive;
            text-align: center; /* Centered text within paragraphs */
            padding: 20px;
            margin: 25px auto; /* Centers the block and provides vertical spacing */
            max-width: 80%; /* Limits paragraph width for better readability */
            background-color: #1a1a1a; /* Slightly lighter charcoal for subtle visual distinction */
            border-radius: 10px;
            color: #b7b8b8; /* A muted grey for standard text */
            box-shadow: 0 0 8px rgba(255, 42, 104, 0.1); /* Very subtle, understated red glow */
            line-height: 1.7; /* Further improved readability */
        }

        /* Subtopic Headings: Consistent with the main radiation theme's subtopics */
        .subtopics {
            background-image: linear-gradient(58.2deg, rgba(255, 76, 10, 0.9) -3%, rgba(255, 0, 80, 0.8) 49.3%, rgba(255, 200, 0, 0.8) 97.7%); /* Intense, mixed-tone gradient */
            font-size: 28px;
            color: #ffffff;
            font-family: 'Audiowide', cursive;
            font-weight: bold;
            padding: 25px 40px;
            margin: 35px auto; /* Centered with generous spacing */
            max-width: 80%;
            text-align: center;
            border-radius: 15px; /* Softer radius for a less rigid feel */
            border: 2px solid #ff416c; /* A clear, vibrant red border */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            transition: all 0.4s ease; /* All-encompassing smooth transition */
            will-change: transform, box-shadow, background;
            cursor: pointer;
        }

        .subtopics:hover {
            transform: scale(1.03) translateY(-3px); /* More noticeable lift and scale */
            background-image: linear-gradient(58.2deg, rgba(255, 0, 80, 0.95) -3%, rgba(255, 76, 10, 0.95) 49.3%, rgba(255, 200, 0, 0.95) 97.7%); /* Even more intense gradient on hover */
            color: #000000; /* Black text for strong contrast on hover */
            box-shadow: 0 0 45px rgba(255, 0, 80, 0.9); /* Enhanced, stronger glow on hover */
        }

        /* Definition Section: Standard content block with clear typography */
        .def {
            background-color: #111111; /* Consistent dark background */
            font-family: 'Audiowide', cursive;
            font-size: 22px; /* Consistent with general paragraphs */
            color: #b7b8b8;
            font-weight: normal; /* Standard weight for content, avoiding excessive boldness */
            text-align: center;
            padding: 30px;
            margin: 35px auto; /* Centered block with consistent spacing */
            max-width: 80%;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 42, 104, 0.15); /* Subtle red glow */
            line-height: 1.7; /* Improved readability */
        }

        /* Fact Section: Highlighted and impactful, drawing attention with electric energy */
        .fact {
            background-color: #0d0d0d; /* Slightly darker than other blocks for more emphasis */
            font-size: 34px;
            color: #00e0ff; /* A vibrant, electric cyan for a striking highlight */
            font-weight: 900;
            font-family: 'Rajdhani', sans-serif; /* A bold, modern sans-serif */
            text-align: center;
            padding: 40px; /* Generous padding for emphasis */
            margin: 35px auto; /* Centers the block */
            max-width: 85%; /* Ensures good presentation on various screen sizes */
            border-radius: 12px;
            box-shadow: 0 0 35px rgba(0, 224, 255, 0.8); /* Intense, bright cyan glow for "energy" */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth interaction on hover */
            will-change: transform, box-shadow; /* Hint to browser for performance optimization */
        }

        .fact:hover {
            transform: scale(1.02); /* Slight scale on hover for a dynamic feel */
            box-shadow: 0 0 50px rgba(0, 224, 255, 1); /* Even brighter, stronger glow on hover */
        }

        /* Tech Points List: Professional styling with custom glowing bullets */
        .tech_points {
            list-style-type: none; /* Removes default bullet points */
            padding: 25px; /* Ample internal spacing */
            margin: 30px auto; /* Centers the block horizontally, adds vertical spacing */
            max-width: 85%; /* Ensures readability on large screens, responsive on small */
            background-color: #1a1a1a; /* A deep charcoal for subtle depth against pure black */
            border-radius: 12px; /* Softly rounded corners for a modern feel */
            box-shadow: 0 0 20px rgba(255, 0, 80, 0.15); /* A subtle, outward glow matching the radiation theme */
            color: #dadada; /* Light grey text for excellent contrast */
            font-family: 'Audiowide', cursive;
            font-size: 20px;
            text-align: left; /* Best for list readability */
            line-height: 1.5; /* Improves text readability */
        }

        .tech_points li {
            padding: 15px 0; /* Vertical padding for each list item */
            border-bottom: 1px solid rgba(255, 255, 255, 0.08); /* A very subtle, transparent line separator */
            position: relative; /* Necessary for positioning the custom bullet point */
            padding-left: 35px; /* Creates space for the custom bullet */
            transition: background-color 0.3s ease, transform 0.2s ease; /* Smooth hover effects */
        }

        .tech_points li:last-child {
            border-bottom: none; /* No separator for the very last item */
        }

        /* Custom glowing bullet point for each list item */
        .tech_points li::before {
            content: ''; /* Required for pseudo-elements */
            position: absolute;
            left: 0; /* Aligns to the left of the padding-left */
            top: 50%;
            transform: translateY(-50%); /* Vertically centers the bullet */
            width: 10px; /* Size of the bullet */
            height: 10px;
            border-radius: 50%; /* Makes it a perfect circle */
            background: linear-gradient(45deg, #00e0ff, #0072ff); /* A cool, vibrant electric cyan gradient */
            box-shadow: 0 0 12px rgba(0, 224, 255, 0.8); /* A strong, matching glow around the bullet */
        }

        .tech_points li:hover {
            background-color: #1a1a1a; /* Slightly lighter black on hover for subtle interaction */
            transform: translateX(5px); /* A subtle slide-right effect on hover */
        }

        /* Atmospheric Attenuation Visualization Specific Styles */
        .attenuation-visual-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 40px auto;
            max-width: 90%;
            background: #111111;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 42, 104, 0.15); /* Subtle red glow for visual containers */
            position: relative;
        }

        .attenuation-representation {
            width: 90%;
            max-width: 700px;
            height: 300px;
            background-color: #0d0d0d;
            border-radius: 10px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5); /* Inner shadow for depth */
        }

        #attenuation-canvas {
            background-color: transparent; /* Canvas background will be drawn by JS */
            display: block;
            width: 100%;
            height: 100%;
        }

        .property-display {
            font-family: 'Courier New', monospace;
            font-size: 24px;
            color: #00e0ff; /* Electric cyan for property display */
            text-shadow: 0 0 10px #00e0ff;
            margin-top: 15px;
            text-align: center;
        }

        .slider-container {
            width: 80%;
            max-width: 500px;
            margin-top: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .property-slider {
            width: 100%;
            -webkit-appearance: none;
            height: 10px;
            background: linear-gradient(to right, #666, #ff416c, #ffcc00); /* Gradient from dark to red to yellow */
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }

        .property-slider:hover {
            opacity: 1;
        }

        .property-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        .property-slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        /* Application examples grid */
        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px auto;
            max-width: 90%;
        }

        .app-item {
            background: #1a1a1a; /* Consistent dark background for app items */
            padding: 20px;
            border-radius: 10px;
            transition: transform 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 198, 255, 0.1); /* Subtle blue glow */
            cursor: pointer;
        }

        .app-item:hover {
            transform: scale(1.03) translateY(-5px); /* Slight lift and scale */
            background: #222222; /* Slightly lighter on hover */
            box-shadow: 0 8px 25px rgba(0, 198, 255, 0.4); /* More pronounced, lifted glow */
        }

        .app-icon {
            font-size: 40px;
            text-align: center;
            margin-bottom: 15px;
            color: #00e0ff; /* Electric cyan for icons */
            text-shadow: 0 0 10px rgba(0, 224, 255, 0.7); /* Glowing icon effect */
        }

        .app-title {
            font-family: 'Rajdhani', sans-serif;
            font-size: 22px;
            color: white;
            margin-bottom: 10px;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main_heading {
                font-size: 40px;
                padding: 30px;
            }
            .subtopics {
                font-size: 22px;
                padding: 12px 20px;
            }
            p, .def {
                font-size: 18px;
                padding: 15px;
                margin: 20px auto;
                max-width: 90%;
            }
            .fact {
                font-size: 28px;
                padding: 30px;
            }
            .tech_points {
                font-size: 18px;
                padding: 20px;
            }
            .tech_points li {
                padding-left: 30px;
            }
            .tech_points li::before {
                width: 8px;
                height: 8px;
            }
            .attenuation-representation {
                height: 250px;
            }
            .property-display {
                font-size: 20px;
            }
            .property-slider {
                height: 8px;
            }
            .property-slider::-webkit-slider-thumb, .property-slider::-moz-range-thumb {
                width: 20px;
                height: 20px;
            }
            .app-grid {
                grid-template-columns: 1fr;
            }
            .app-icon {
                font-size: 36px;
            }
            .app-title {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            .main_heading {
                font-size: 32px;
                padding: 20px;
            }
            .subtopics {
                font-size: 18px;
                padding: 10px 15px;
            }
            p, .def {
                font-size: 16px;
                padding: 12px;
                margin: 15px auto;
            }
            .fact {
                font-size: 24px;
                padding: 25px;
            }
            .tech_points {
                font-size: 16px;
                padding: 15px;
            }
            .tech_points li {
                padding-left: 25px;
            }
            .tech_points li::before {
                width: 6px;
                height: 6px;
            }
            .attenuation-representation {
                height: 200px;
            }
            .property-display {
                font-size: 18px;
            }
            .property-slider {
                height: 6px;
            }
            .property-slider::-webkit-slider-thumb, .property-slider::-moz-range-thumb {
                width: 18px;
                height: 18px;
            }
            .app-icon {
                font-size: 32px;
            }
            .app-title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>

    <div class="main_heading">Atmospheric Attenuation of Radiation</div>

    <div class="def">
        <p><b>Atmospheric Attenuation</b> refers to the reduction in the intensity of electromagnetic radiation (like sunlight) as it passes through Earth's atmosphere. This reduction occurs due to two primary processes: <b>absorption</b> and <b>scattering</b>.</p>
        <p>Understanding atmospheric attenuation is crucial for fields ranging from solar energy and remote sensing to climate science and astronomy, as it dictates how much radiation reaches the Earth's surface or escapes into space.</p>
    </div>

    <div class="subtopics">Mechanisms of Atmospheric Attenuation</div>

    <div class="def">
        <ul class="tech_points">
            <li><b>Absorption:</b> Certain atmospheric gases (e.g., $\text{O}_3$, $\text{H}_2\text{O}$, $\text{CO}_2$) absorb specific wavelengths of radiation, converting the radiative energy into internal energy (heat) of the molecules. This creates "gaps" or "absorption bands" in the solar spectrum.</li>
            <li><b>Scattering:</b> Radiation is redirected from its original path by interacting with atmospheric particles (molecules, aerosols, clouds).
                <ul>
                    <li><b>Rayleigh Scattering:</b> Occurs when radiation interacts with particles much smaller than its wavelength (e.g., air molecules). It's wavelength-dependent, scattering shorter (blue) wavelengths more effectively, which is why the sky is blue.</li>
                    <li><b>Mie Scattering:</b> Occurs when radiation interacts with particles comparable to or larger than its wavelength (e.g., dust, pollen, water droplets in clouds). It's less wavelength-dependent and causes haziness or white clouds.</li>
                </ul>
            </li>
            <li><b>Extinction:</b> The combined effect of absorption and scattering, leading to the overall reduction in radiation intensity.</li>
        </ul>
    </div>

    <div class="subtopics">Interactive Attenuation Demonstration</div>

    <div class="attenuation-visual-container">
        <h3>Radiation Passing Through Atmosphere</h3>
        <div class="attenuation-representation">
            <canvas id="attenuation-canvas"></canvas>
        </div>
        <div class="property-display" id="atmosphere-density-display">Atmosphere Density: 50%</div>
        <div class="property-display" id="transmitted-radiation-display">Transmitted: 0</div>
        <div class="property-display" id="absorbed-radiation-display">Absorbed: 0</div>
        <div class="property-display" id="scattered-radiation-display">Scattered: 0</div>
        <div class="slider-container">
            <input type="range" min="0" max="100" value="50" class="property-slider" id="density-slider">
            <span>Adjust Atmosphere Density (%)</span>
        </div>
        <p>Observe how increasing the "Atmosphere Density" affects incoming "solar particles." Some particles are absorbed (disappear), others are scattered (change direction), and fewer are transmitted to the "surface."</p>
    </div>

    <div class="fact">
        DID YOU KNOW? The red and orange colors of sunsets and sunrises are a result of Rayleigh scattering. When the sun is low on the horizon, sunlight travels through more atmosphere, scattering away most of the blue and green light, leaving the longer red and orange wavelengths to reach our eyes!
    </div>

    <div class="subtopics">Applications of Atmospheric Attenuation</div>

    <div class="def">
        <ul class="tech_points">
            <li><b>Solar Energy Forecasting:</b> Predicting the amount of sunlight available for solar power generation, accounting for clouds, aerosols, and atmospheric gases.</li>
            <li><b>Remote Sensing and Satellite Imagery:</b> Correcting satellite data for atmospheric effects to obtain accurate information about Earth's surface and atmosphere.</li>
            <li><b>Climate Modeling:</b> Quantifying the radiative forcing of greenhouse gases and aerosols, which directly impacts Earth's energy balance and climate.</li>
            <li><b>Optical Communications:</b> Designing free-space optical communication systems (e.g., laser links) that account for atmospheric absorption and scattering.</li>
            <li><b>Astronomy:</b> Choosing optimal observatory locations (e.g., high altitudes, dry climates) to minimize atmospheric interference for astronomical observations.</li>
            <li><b>Lighting Design:</b> Understanding how atmospheric conditions affect natural light penetration into buildings.</li>
        </ul>
    </div>

    <div class="app-grid">
        <div class="app-item">
            <div class="app-icon">‚òÄÔ∏è</div>
            <div class="app-title">Solar Power</div>
            <p>Predicting energy output based on atmospheric clarity.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">üõ∞Ô∏è</div>
            <div class="app-title">Satellite Imaging</div>
            <p>Correcting images for atmospheric distortion.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">üìà</div>
            <div class="app-title">Climate Science</div>
            <p>Modeling the impact of atmospheric composition on temperature.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">üî≠</div>
            <div class="app-title">Observatories</div>
            <p>Minimizing atmospheric blur for clear cosmic views.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">üí°</div>
            <div class="app-title">Outdoor Lighting</div>
            <p>Designing systems for visibility through haze or fog.</p>
        </div>
        <div class="app-item">
            <div class="app-icon">‚úàÔ∏è</div>
            <div class="app-title">Aviation Safety</div>
            <p>Visibility and laser guidance through atmospheric conditions.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('attenuation-canvas');
            const ctx = canvas.getContext('2d');
            const densitySlider = document.getElementById('density-slider');
            const atmosphereDensityDisplay = document.getElementById('atmosphere-density-display');
            const transmittedRadiationDisplay = document.getElementById('transmitted-radiation-display');
            const absorbedRadiationDisplay = document.getElementById('absorbed-radiation-display');
            const scatteredRadiationDisplay = document.getElementById('scattered-radiation-display');

            // Set canvas dimensions to match its container
            const setCanvasDimensions = () => {
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                particles = []; // Clear particles on resize
                transmittedCount = 0;
                absorbedCount = 0;
                scatteredCount = 0;
                drawAttenuationScene(); // Redraw on resize
            };

            // Particle properties (representing radiation/photons)
            const particleRadius = 2;
            const particleColor = '#ffcc00'; // Yellow/orange for incoming radiation
            const scatteredParticleColor = '#00e0ff'; // Cyan for scattered radiation
            const particleSpeed = 2.5;
            const maxParticles = 150; // Max particles visible at once
            let particles = [];

            // Atmosphere layer properties
            const atmosphereWidth = canvas.width * 0.4;
            const atmosphereX = canvas.width * 0.3; // Centered atmosphere layer
            const atmosphereHeight = canvas.height * 0.9;
            const atmosphereY = (canvas.height - atmosphereHeight) / 2;
            const atmosphereColorBase = 'rgba(0, 198, 255, 0.05)'; // Very faint blue for atmosphere
            const atmosphereGlowColor = 'rgba(0, 198, 255, 0.5)'; // Blue glow for atmosphere

            let transmittedCount = 0;
            let absorbedCount = 0;
            let scatteredCount = 0;

            // Animation loop
            let animationFrameId;

            function createParticle() {
                // Particles originate from the left edge (Source), randomly along Y
                return {
                    x: 0,
                    y: Math.random() * canvas.height,
                    vx: particleSpeed + Math.random() * 0.5, // Slight speed variation
                    vy: (Math.random() - 0.5) * 0.5, // Slight vertical drift
                    color: particleColor,
                    active: true,
                    inAtmosphere: false // To track if particle has entered atmosphere
                };
            }

            function updateParticles() {
                const densityEffect = parseFloat(densitySlider.value) / 100; // 0 to 1

                // Filter out inactive particles
                particles = particles.filter(p => p.active);

                // Add new incoming particles from source (left side)
                if (particles.filter(p => p.x < atmosphereX).length < maxParticles / 2 && Math.random() < 0.8) {
                    particles.push(createParticle());
                }

                for (let i = 0; i < particles.length; i++) {
                    const p = particles[i];

                    p.x += p.vx;
                    p.y += p.vy;

                    // Bounce off top/bottom edges
                    if (p.y < 0 || p.y > canvas.height) {
                        p.vy *= -1;
                    }

                    // Check interaction with atmosphere layer
                    if (p.x >= atmosphereX && p.x <= atmosphereX + atmosphereWidth && p.active) {
                        if (!p.inAtmosphere) {
                            p.inAtmosphere = true; // Mark as entered atmosphere
                        }

                        // Absorption
                        if (Math.random() < densityEffect * 0.03) { // Absorption probability scaled by density
                            p.active = false; // Particle absorbed
                            absorbedCount++;
                            continue; // Skip to next particle
                        }

                        // Scattering
                        if (Math.random() < densityEffect * 0.05) { // Scattering probability scaled by density
                            p.vx = (Math.random() - 0.5) * particleSpeed * 2; // Randomize direction
                            p.vy = (Math.random() - 0.5) * particleSpeed * 2;
                            p.color = scatteredParticleColor; // Change color to indicate scattering
                            scatteredCount++;
                        }
                    }

                    // If particle reached the "surface" (right side)
                    if (p.x > canvas.width * 0.9 && p.active && p.inAtmosphere) {
                        transmittedCount++;
                        p.active = false; // Mark as transmitted and remove
                    }

                    // Remove particles that go off screen
                    if (p.x > canvas.width + particleRadius || p.x < -particleRadius || p.y > canvas.height + particleRadius || p.y < -particleRadius) {
                        p.active = false;
                    }
                }

                // Update displays
                transmittedRadiationDisplay.textContent = `Transmitted: ${transmittedCount}`;
                absorbedRadiationDisplay.textContent = `Absorbed: ${absorbedCount}`;
                scatteredRadiationDisplay.textContent = `Scattered: ${scatteredCount}`;
            }

            function drawAttenuationScene() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const densityEffect = parseFloat(densitySlider.value) / 100; // 0 to 1

                // Draw Source (left side)
                ctx.fillStyle = 'rgba(255, 200, 0, 0.8)'; // Yellow source
                ctx.beginPath();
                ctx.arc(canvas.width * 0.08, canvas.height / 2, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowColor = 'rgba(255, 200, 0, 1)';
                ctx.shadowBlur = 15;
                ctx.font = '20px "Rajdhani", sans-serif';
                ctx.fillStyle = '#ffffff';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('Source', canvas.width * 0.08, canvas.height / 2 + 40);
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Earth's Surface (right side)
                ctx.fillStyle = 'rgba(0, 150, 0, 0.8)'; // Green Earth
                ctx.beginPath();
                ctx.rect(canvas.width * 0.9, 0, canvas.width * 0.1, canvas.height);
                ctx.fill();
                ctx.shadowColor = 'rgba(0, 150, 0, 1)';
                ctx.shadowBlur = 20;
                ctx.fillStyle = '#ffffff';
                ctx.fillText('Surface', canvas.width * 0.95, canvas.height / 2);
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Atmosphere Layer
                // Adjust atmosphere color/glow based on density
                const atmosphereOpacity = 0.05 + (densityEffect * 0.3); // From 0.05 (faint) to 0.35 (more visible)
                const atmosphereColor = `rgba(0, 198, 255, ${atmosphereOpacity})`; // Blueish for atmosphere
                ctx.fillStyle = atmosphereColor;
                ctx.fillRect(atmosphereX, atmosphereY, atmosphereWidth, atmosphereHeight);

                // Add a glow to the atmosphere layer (simulating scattering/absorption)
                const glowIntensity = densityEffect * 15; // 0 to 15px blur
                ctx.shadowColor = atmosphereGlowColor;
                ctx.shadowBlur = glowIntensity;
                ctx.fillRect(atmosphereX, atmosphereY, atmosphereWidth, atmosphereHeight); // Redraw to apply shadow
                ctx.shadowBlur = 0; // Reset shadow

                // Draw Particles
                particles.forEach(p => {
                    if (p.active) {
                        ctx.fillStyle = p.color;
                        ctx.shadowColor = p.color;
                        ctx.shadowBlur = 5; // Particle glow
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, particleRadius, 0, Math.PI * 2);
                        ctx.fill();
                    }
                });
                ctx.shadowBlur = 0; // Reset particle shadow

                // Update display text for atmosphere density
                atmosphereDensityDisplay.textContent = `Atmosphere Density: ${densitySlider.value}%`;

                animationFrameId = requestAnimationFrame(drawAttenuationScene);
                updateParticles(); // Update particle positions and logic
            }

            // Event listener for slider
            densitySlider.addEventListener('input', () => {
                // When slider changes, immediately update display
                atmosphereDensityDisplay.textContent = `Atmosphere Density: ${densitySlider.value}%`;
                // Reset counts and particles to restart simulation with new settings
                transmittedCount = 0;
                absorbedCount = 0;
                scatteredCount = 0;
                particles = [];
            });

            // Initial setup
            setCanvasDimensions();
            window.addEventListener('resize', setCanvasDimensions);

            // Start animation loop
            animationFrameId = requestAnimationFrame(drawAttenuationScene);
        });
    </script>

</body>
</html>
